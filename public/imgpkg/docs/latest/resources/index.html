<!DOCTYPE html>
<!-- docs/baseof.html -->
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="icon" type="image/png" href="/img/favicon.png">
    
    
    <link rel="stylesheet" href="/css/style.css" integrity="" media="screen">
    <script src="/js/main.js" type="text/javascript"></script>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> 
  
    
      
      <meta name="robots" content="noindex">
    
    <title>Carvel - imgpkg - Resources</title>
  </head>

  <body id="docs">
    

<header class="in-subproject">
	<div class="wrapper">
		<a href="/"><img class="image" src="/img/logo.svg" alt="Carvel Logo" /></a>
		<ul class="desktop-links">
			<li><a href="/" >Home</a></li>
			<li class="subprojects-in-primary-nav">
				<a href="/" onclick="return false;">Projects</a>
				<ul>
					
					
					<li><a href="/ytt/" >ytt</a></li>
					
					
					<li><a href="/kbld/" >kbld</a></li>
					
					
					<li><a href="/kapp/" >kapp</a></li>
					
					
					<li><a href="/imgpkg/" >imgpkg</a></li>
					
					
					<li><a href="https://github.com/vmware-tanzu/carvel-kapp-controller" >kapp-controller</a></li>
					
					
					<li><a href="/vendir/" >vendir</a></li>
					
				</ul>
			</li>
			<li><a href="/community/" >Community</a></li>
			<li><a href="/blog/" >Blog</a></li>
			<li><a href="https://kubernetes.slack.com/archives/CH8KCCKA5"><img src="/img/slack.png" />#carvel in Kubernetes Slack</a></li>
		</ul>
		<button type="button" class="mobile" onclick="mobileNavToggle()">
			<img class="collapsed-icon" src="/img/hamburger.svg" alt="Mobile nav icon">
			<img class="expanded-icon" src="/img/close.svg" alt="Mobile nav icon">
		</button>
		<div id="mobile-menu" class="mobile-menu mobile">
			<ul class="header-links">
				<li><a href="/" >Home</a></li>
				<li>
					<a href="/">Projects</a>
					<ul>
						
						
						<li><a href="/ytt/" >ytt</a></li>
						
						
						<li><a href="/kbld/" >kbld</a></li>
						
						
						<li><a href="/kapp/" >kapp</a></li>
						
						
						<li><a href="/imgpkg/" >imgpkg</a></li>
						
						
						<li><a href="https://github.com/vmware-tanzu/carvel-kapp-controller" >kapp-controller</a></li>
						
						
						<li><a href="/vendir/" >vendir</a></li>
						
					</ul>
				</li>
				<li><a href="/community/" >Community</a></li>
				<li><a href="/blog/" >Blog</a></li>
			</ul>
			<div class="social">
				<a href="https://github.com/vmware-tanzu/carvel.dev"><img src="/img/github.svg" />GitHub</a>
				<a href="https://kubernetes.slack.com/archives/CH8KCCKA5"><img src="/img/slack.png" />#carvel in Kubernetes Slack</a>
			</div>
		</div>
	</div>
</header>



<header class="subproject-specific">
	<div class="wrapper">
		<a href="/imgpkg/" class="text-logo">imgpkg</a>
		<ul class="desktop-links">
			<li><a href="/imgpkg/" >imgpkg Overview</a></li>
			<li><a href="/imgpkg/docs/latest/" >Documentation</a></li>
			<li><a href="https://github.com/vmware-tanzu/carvel-imgpkg"><img src="/img/github.svg" />GitHub</a></li>
		</ul>
		<ul class="mobile-links mobile">
			<li><a href="/imgpkg/docs/latest/" >Docs</a></li>
			<li><a href="https://github.com/vmware-tanzu/carvel-imgpkg"><img src="/img/github.svg" />GitHub</a></li>
		</ul>
	</div>
</header>


    <main>
      <div class="wrapper dedicated-page docs clearfix">
        <div class="side-nav">
          
<div class="dropdown">
    
        <span>latest</span>
    
</div>

          
    
    <form class="d-flex align-items-center">
        <span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;">
        <input type="search" class="form-control docsearch-input" id="search-input" placeholder="Search..."
                aria-label="Search for..." autocomplete="off" spellcheck="false" role="combobox"
                aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0"
                dir="auto" style="position: relative; vertical-align: top;">
        </span>
    </form>

          <nav class="navigation">
  
  
  
  
    
    
    
    

    
      <h3>Introduction</h3>
      <ul>
        
          <li>
            
              
              <a href="/imgpkg/docs/latest/" >About imgpkg</a>
            
          </li>
        
      </ul>
    
      <h3>Workflows</h3>
      <ul>
        
          <li>
            
              
              <a href="/imgpkg/docs/latest/basic-workflow/" >Basic workflow</a>
            
          </li>
        
          <li>
            
              
              <a href="/imgpkg/docs/latest/air-gapped-workflow/" >Air-gapped workflow</a>
            
          </li>
        
      </ul>
    
      <h3>Reference</h3>
      <ul>
        
          <li>
            
              
              <a href="/imgpkg/docs/latest/auth/" >Authentication</a>
            
          </li>
        
          <li>
            
              
              <a href="/imgpkg/docs/latest/resources/" class="active">Resources</a>
            
          </li>
        
          <li>
            
              
              <a href="/imgpkg/docs/latest/commands/" >Commands</a>
            
          </li>
        
          <li>
            
              
              <a href="/imgpkg/docs/latest/working-directly-with-images/" >Working directly with images</a>
            
          </li>
        
      </ul>
    
      <h3>FAQ</h3>
      <ul>
        
          <li>
            
              
              <a href="/imgpkg/docs/latest/security/" >Security</a>
            
          </li>
        
      </ul>
    
  
</nav>

        </div>
        <div class="docs-content text-content">
          

	


          <div class="documentation-container">
            <h1>Resources</h1>
            
                <aside>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#image">Image</a></li>
    <li><a href="#bundle">Bundle</a></li>
    <li><a href="#imgpkg-directory"><code>.imgpkg</code> directory</a></li>
    <li><a href="#bundle-configuration">Bundle configuration</a></li>
    <li><a href="#imageslock-configuration">ImagesLock configuration</a></li>
    <li><a href="#bundlelock-configuration">BundleLock configuration</a></li>
    <li><a href="#nested-bundle">Nested Bundle</a></li>
  </ul>
</nav>
                </aside>
            

            <h2 id="image">Image <a href="#image" class="section-link">¶</a></h2><p>An OCI image is an artifact that lives within an OCI registry (such as DockerHub). It can contain an arbitrary number of files.</p>
<hr>
<h2 id="bundle">Bundle <a href="#bundle" class="section-link">¶</a></h2><p>A bundle is an OCI image that holds 0+ arbitrary files <em>and</em> 0+ references to dependent OCI images (which <em>may</em> also be <a href="#nested-bundle">bundles</a>). By tracking dependent images, imgpkg can copy bundles across registries.</p>
<p>Referenced images are stored within the <a href="#imgpkg-directory"><code>.imgpkg</code> directory</a> at the root level of the bundle image.</p>
<p>


    
        
    

<p>
    <img src="/images/imgpkg/bundle-diagram.png" alt="Bundle diagram"  />
</p></p>
<p>Implementation note: A bundle OCI image has the <code>dev.carvel.imgpkg.bundle</code> <a href="https://docs.docker.com/config/labels-custom-metadata/" target="_blank">label</a> set.</p>
<hr>
<h2 id="imgpkg-directory"><code>.imgpkg</code> directory <a href="#imgpkg-directory" class="section-link">¶</a></h2><p><code>.imgpkg</code> directory contains metadata files describing bundle:</p>
<ul>
<li>
<p><code>images.yml</code> (required) contains <a href="#imageslock-configuration">ImagesLock configuration</a> that describes 0+ dependent OCI images. Consumers of bundles can rely on this file being always present.</p>
</li>
<li>
<p><code>bundle.yml</code> (optional) file contains <a href="#bundle-configuration">Bundle configuration</a> that contains details about bundle authors, associated websites, etc.</p>
</li>
</ul>
<p>Restrictions for location of <code>.imgpkg</code> directory:</p>
<ul>
<li>
<p>Only one <code>.imgpkg</code> directory is allowed across all directories provided via <code>-f</code> to the <code>push</code> command. This restriction ensures there is a single source of bundle metadata and referenced images.</p>
</li>
<li>
<p>The <code>.imgpkg</code> directory must be a direct child of one of the input directories. This prevents any confusion around the scope of the <code>.imgpkg</code> metadata.</p>
</li>
</ul>
<hr>
<h2 id="bundle-configuration">Bundle configuration <a href="#bundle-configuration" class="section-link">¶</a></h2><p>Used by bundle creators to store general information about the bundle. Stored in <code>.imgpkg/bundle.yml</code>.</p>
<p>Example:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#000080">apiVersion</span>:<span style="color:#bbb"> </span>imgpkg.carvel.dev/v1alpha1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">kind</span>:<span style="color:#bbb"> </span>Bundle<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">name</span>:<span style="color:#bbb"> </span>my-bundle<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">authors</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#000080">name</span>:<span style="color:#bbb"> </span>Full Name<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">email</span>:<span style="color:#bbb"> </span>name@example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">websites</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#000080">url</span>:<span style="color:#bbb"> </span>example.com<span style="color:#bbb">
</span></code></pre></div><ul>
<li><code>authors</code> (array of structs; optional)
<ul>
<li><code>name</code> (string) Author name</li>
<li><code>email</code> (string) Author email</li>
</ul>
</li>
<li><code>websites</code> (array of structs; optional)
<ul>
<li><code>url</code> (string) Related website URL</li>
</ul>
</li>
</ul>
<hr>
<h2 id="imageslock-configuration">ImagesLock configuration <a href="#imageslock-configuration" class="section-link">¶</a></h2><p>An ImagesLock configuration is used to track a collection of image references.</p>
<p>Bundle&rsquo;s <code>.imgpkg/images.yml</code> contains ImagesLock configuration. That&rsquo;s how bundle knows which OCI images it references. When copying a bundle <code>imgpkg</code> uses this configuration to know which images to copy.</p>
<p>It can be conveniently generated with <a href="/kbld/">kbld</a>:</p>
<pre><code class="language-bash-plain" data-lang="bash-plain">$ kbld -f config.yml --imgpkg-lock-output .imgpkg/images.yml
</code></pre><p>Example:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#000080">apiVersion</span>:<span style="color:#bbb"> </span>imgpkg.carvel.dev/v1alpha1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">kind</span>:<span style="color:#bbb"> </span>ImagesLock<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">images</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#000080">image</span>:<span style="color:#bbb"> </span>docker.io/user1/my-app@sha256:42462d0cb227497976754bb67348bdd7471c7bd159819d6bd63fdf479eb7eb19<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">annotations</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">kbld.carvel.dev/id</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;my-app:v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#000080">image</span>:<span style="color:#bbb"> </span>gcr.io/projectX/controller@sha256:6ecba6f14373a449f8d54fa4286f57fb8ef37c4ffa637969551f2fda52672206<span style="color:#bbb">
</span></code></pre></div><ul>
<li><code>images</code> (array of images): 0+ images
<ul>
<li><code>image</code> (string; required) digest reference to OCI image (tag references are not allowed)</li>
<li><code>annotations</code> (map[string]string; optional) arbitrary additional data about image reference. Expected to be used by tools that create or read ImagesLock configuration. Example: <a href="/kbld/">kbld</a> uses annotations to store an identifier that can later tell it which location(s) within a Kubernetes configuration to update with the digest reference.</li>
</ul>
</li>
</ul>
<p>Advanced non-bundle use: See <a href="/imgpkg/docs/latest/commands/#copying-via-lock-file">copying via lock files</a>.</p>
<hr>
<h2 id="bundlelock-configuration">BundleLock configuration <a href="#bundlelock-configuration" class="section-link">¶</a></h2><p>Stores a digest reference to a bundle (as well as the tag it was pushed with).</p>
<p>This configuration is generated by the <code>--lock-output</code> flag during a <code>push</code> command.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">$ imgpkg push -b ... --lock-output /tmp/lock.yml<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>$ cat /tmp/lock.yml<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">apiVersion</span>:<span style="color:#bbb"> </span>imgpkg.carvel.dev/v1alpha1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">kind</span>:<span style="color:#bbb"> </span>BundleLock<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">bundle</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>docker.io/my-app@sha256:b12026c7a0a6a1756a82a2a74ac759e9a7036523faca0e33dbddebc214e097df<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">tag</span>:<span style="color:#bbb"> </span>v1.0<span style="color:#bbb">
</span></code></pre></div><hr>
<h2 id="nested-bundle">Nested Bundle <a href="#nested-bundle" class="section-link">¶</a></h2><p>A nested bundle is a bundle referenced from a &lsquo;parent&rsquo; bundle in its <code>ImagesLock</code> configuration.</p>
<p>Having a bundle &lsquo;reference&rsquo; another bundle is no different from referencing any other OCI image. The copy and pull commands work the same as dealing with any OCI image.</p>
<p>


    
        
    

<p>
    <img src="/images/imgpkg/nested-bundle-diagram.png" alt="Nested Bundle diagram"  />
</p></p>
<p>One key difference between nested bundles and other OCI images, is the directory structure when <code>imgpkg pull</code> writes the nested bundle&rsquo;s content to disk.</p>
<p>For further details refer to <a href="/imgpkg/docs/latest/commands/#pulling-nested-bundles">pulling a nested bundle.</a></p>

          </div>
        </div>
      </div>
    </main>
    <footer>
	<div class="wrapper footer-links">
		<div class="clearfix">
			<ul class="left-links">
				<li><a href="https://twitter.com/carvel_dev"><img src="/img/twitter.png" />Twitter</a></li>
				<li><a href="https://github.com/vmware-tanzu/carvel.dev"><img src="/img/github.svg" />Github</a></li>
				<li><a href="https://kubernetes.slack.com/archives/CH8KCCKA5">
					<img src="/img/slack.png" />
					<span class="desktop">#carvel in Kubernetes Slack</span>
					<span class="mobile">Slack</span>
				</a></li>
			</ul>
			<div class="right-links">
				<a href="/"> <img src="/img/logo.svg" /></a>
			</div>
		</div>
		<div class="bottom-links">
			<p class="copywrite">&copy; 2021 Carvel Authors. <a href="http://vmware.github.io/">A VMware-backed project. <img src="/img/vm-logo.svg" /></a></p>
		</div>
	</div>
</footer>

    
    
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
      <script type="text/javascript">
        docsearch({
          apiKey: '582b1408d7a3fe145c0f84f48ca03755',
          indexName: 'carvel',
          inputSelector: '.docsearch-input',
          algoliaOptions: {'facetFilters': ["tags:imgpkg"], hitsPerPage: 9},
          debug: false 
        });
      </script>
    
  </body>
</html>
