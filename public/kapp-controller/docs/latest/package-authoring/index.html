<!DOCTYPE html>
<!-- docs/baseof.html -->
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="icon" type="image/png" href="/img/favicon.png">
    
    
    <link rel="stylesheet" href="/css/style.css" integrity="" media="screen">
    <script src="/js/main.js" type="text/javascript"></script>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> 
  
    
      
      <meta name="robots" content="noindex">
    
    <title>Carvel - kapp-controller - Package Authoring</title>
  </head>

  <body id="docs">
    

<header class="in-subproject">
	<div class="wrapper">
		<a href="/"><img class="image" src="/img/logo.svg" alt="Carvel Logo" /></a>
		<ul class="desktop-links">
			<li><a href="/" >Home</a></li>
			<li class="subprojects-in-primary-nav">
				<a href="/" onclick="return false;">Projects</a>
				<ul>
					
					
					<li><a href="/ytt/" >ytt</a></li>
					
					
					<li><a href="/kbld/" >kbld</a></li>
					
					
					<li><a href="/kapp/" >kapp</a></li>
					
					
					<li><a href="/imgpkg/" >imgpkg</a></li>
					
					
					<li><a href="https://github.com/vmware-tanzu/carvel-kapp-controller" >kapp-controller</a></li>
					
					
					<li><a href="/vendir/" >vendir</a></li>
					
				</ul>
			</li>
			<li><a href="/community/" >Community</a></li>
			<li><a href="/blog/" >Blog</a></li>
			<li><a href="https://kubernetes.slack.com/archives/CH8KCCKA5"><img src="/img/slack.png" />#carvel in Kubernetes Slack</a></li>
		</ul>
		<button type="button" class="mobile" onclick="mobileNavToggle()">
			<img class="collapsed-icon" src="/img/hamburger.svg" alt="Mobile nav icon">
			<img class="expanded-icon" src="/img/close.svg" alt="Mobile nav icon">
		</button>
		<div id="mobile-menu" class="mobile-menu mobile">
			<ul class="header-links">
				<li><a href="/" >Home</a></li>
				<li>
					<a href="/">Projects</a>
					<ul>
						
						
						<li><a href="/ytt/" >ytt</a></li>
						
						
						<li><a href="/kbld/" >kbld</a></li>
						
						
						<li><a href="/kapp/" >kapp</a></li>
						
						
						<li><a href="/imgpkg/" >imgpkg</a></li>
						
						
						<li><a href="https://github.com/vmware-tanzu/carvel-kapp-controller" >kapp-controller</a></li>
						
						
						<li><a href="/vendir/" >vendir</a></li>
						
					</ul>
				</li>
				<li><a href="/community/" >Community</a></li>
				<li><a href="/blog/" >Blog</a></li>
			</ul>
			<div class="social">
				<a href="https://github.com/vmware-tanzu/carvel.dev"><img src="/img/github.svg" />GitHub</a>
				<a href="https://kubernetes.slack.com/archives/CH8KCCKA5"><img src="/img/slack.png" />#carvel in Kubernetes Slack</a>
			</div>
		</div>
	</div>
</header>



<header class="subproject-specific">
	<div class="wrapper">
		<a href="https://github.com/vmware-tanzu/carvel-kapp-controller" class="text-logo">kapp-controller</a>
		<ul class="desktop-links">
			<li><a href="https://github.com/vmware-tanzu/carvel-kapp-controller" >kapp-controller Overview</a></li>
			<li><a href="/kapp-controller/docs/latest/" >Documentation</a></li>
			<li><a href="https://github.com/vmware-tanzu/carvel-kapp-controller"><img src="/img/github.svg" />GitHub</a></li>
		</ul>
		<ul class="mobile-links mobile">
			<li><a href="/kapp-controller/docs/latest/" >Docs</a></li>
			<li><a href="https://github.com/vmware-tanzu/carvel-kapp-controller"><img src="/img/github.svg" />GitHub</a></li>
		</ul>
	</div>
</header>


    <main>
      <div class="wrapper dedicated-page docs clearfix">
        <div class="side-nav">
          
<div class="dropdown">
    
        <span>latest</span>
    
</div>

          
    
    <form class="d-flex align-items-center">
        <span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;">
        <input type="search" class="form-control docsearch-input" id="search-input" placeholder="Search..."
                aria-label="Search for..." autocomplete="off" spellcheck="false" role="combobox"
                aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0"
                dir="auto" style="position: relative; vertical-align: top;">
        </span>
    </form>

          <nav class="navigation">
  
  
  
  
    
    
    
    

    
      <h3>Introduction</h3>
      <ul>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/" >About kapp-controller</a>
            
          </li>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/install/" >Install</a>
            
          </li>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/walkthrough/" >Walkthrough</a>
            
          </li>
        
      </ul>
    
      <h3>Reference</h3>
      <ul>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/app-spec/" >App CR Spec</a>
            
          </li>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/config/" >Configuration</a>
            
          </li>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/controller-config/" >Controller Configuration</a>
            
          </li>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/startup/" >Controller Startup</a>
            
          </li>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/security-model/" >Security Model</a>
            
          </li>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/dangerous-flags/" >Dangerous Flags</a>
            
          </li>
        
      </ul>
    
      <h3>Template steps</h3>
      <ul>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/sops/" >Mozilla&#39;s sops</a>
            
          </li>
        
      </ul>
    
      <h3>Packaging (alpha)</h3>
      <ul>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/packaging/" >Terminology &amp; APIs</a>
            
          </li>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/install-alpha/" >Install</a>
            
          </li>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/package-authoring/" class="active">Authoring packages</a>
            
          </li>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/package-consumption/" >Consuming packages</a>
            
          </li>
        
      </ul>
    
      <h3>FAQ</h3>
      <ul>
        
          <li>
            
              
              <a href="/kapp-controller/docs/latest/security/" >Security</a>
            
          </li>
        
      </ul>
    
  
</nav>

        </div>
        <div class="docs-content text-content">
          

	


          <div class="documentation-container">
            <h1>Package Authoring</h1>
            
                <aside>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#prerequisites">Prerequisites</a></li>
    <li><a href="#creating-a-package">Creating a package</a>
      <ul>
        <li><a href="#configuration">Configuration</a></li>
        <li><a href="#package-contents-bundle">Package Contents Bundle</a></li>
        <li><a href="#creating-the-package-cr">Creating the Package CR</a></li>
        <li><a href="#testing-your-package">Testing your package</a></li>
        <li><a href="#creating-a-package-repository">Creating a Package Repository</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </aside>
            

            <p>Available in <a href="https://github.com/vmware-tanzu/carvel-kapp-controller/tree/dev-packaging/alpha-releases" target="_blank">v0.17.0-alpha.1+</a></p>
<p>Before jumping in, we recommend reading through the docs about the new <a href="/kapp-controller/docs/latest/packaging/">packaging
APIs</a> to familiarize yourself with the YAML configuration used in these
workflows.</p>
<p>This workflow walks through an example that will help a user transform a stack
of plain Kubernetes manifests in to a Package within a PackageRepository. This will
allow them to distribute their apps in a way that is easily installable by any
consumers running a kapp-controller in their cluster.</p>
<h2 id="prerequisites">Prerequisites <a href="#prerequisites" class="section-link">¶</a></h2><p>To go through the examles below, the following prerequisites are assumed:</p>
<ul>
<li>You will need to <a href="/kapp-controller/docs/latest/install-alpha/">install the alpha release</a> of kapp-controller on a Kubernetes cluster.</li>
<li>These workflows also assume some of the other Carvel tools are installed on your
system, namely <code>kapp</code>, <code>imgpkg</code>, and <code>kbld</code>. For more info on how to install
these, see our <a href="/#whole-suite">install section on the homepage</a>.</li>
</ul>
<h2 id="creating-a-package">Creating a package <a href="#creating-a-package" class="section-link">¶</a></h2><h3 id="configuration">Configuration <a href="#configuration" class="section-link">¶</a></h3><p>For this demo, we will be using <a href="/ytt/">ytt</a> templates that describe simple Kubernetes Deployment and Service. These templates will install a simple greeter app with a templated hello message. The templates consist of two files:</p>
<p><code>config.yml</code>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#998;font-style:italic">#@ load(&#34;@ytt:data&#34;, &#34;data&#34;)</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">#@ def labels():</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">simple-app</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">#@ end</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#555">---</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">kind</span>:<span style="color:#bbb"> </span>Service<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">namespace</span>:<span style="color:#bbb"> </span>default<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">name</span>:<span style="color:#bbb"> </span>simple-app<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">ports</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#000080">port</span>:<span style="color:#bbb"> </span><span style="color:#998;font-style:italic">#@ data.values.svc_port</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">targetPort</span>:<span style="color:#bbb"> </span><span style="color:#998;font-style:italic">#@ data.values.app_port</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">selector</span>:<span style="color:#bbb"> </span><span style="color:#998;font-style:italic">#@ labels()</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#555">---</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">apiVersion</span>:<span style="color:#bbb"> </span>apps/v1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">kind</span>:<span style="color:#bbb"> </span>Deployment<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">namespace</span>:<span style="color:#bbb"> </span>default<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">name</span>:<span style="color:#bbb"> </span>simple-app<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">selector</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">matchLabels</span>:<span style="color:#bbb"> </span><span style="color:#998;font-style:italic">#@ labels()</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">template</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">labels</span>:<span style="color:#bbb"> </span><span style="color:#998;font-style:italic">#@ labels()</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">containers</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#000080">name</span>:<span style="color:#bbb"> </span>simple-app<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>docker.io/dkalinin/k8s-simple-app@sha256:4c8b96d4fffdfae29258d94a22ae4ad1fe36139d47288b8960d9958d1e63a9d0<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#000080">env</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>- <span style="color:#000080">name</span>:<span style="color:#bbb"> </span>HELLO_MSG<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#000080">value</span>:<span style="color:#bbb"> </span><span style="color:#998;font-style:italic">#@ data.values.hello_msg</span><span style="color:#bbb">
</span></code></pre></div><p>and <code>values.yml</code>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#998;font-style:italic">#@data/values</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#555">---</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">svc_port</span>:<span style="color:#bbb"> </span><span style="color:#099">80</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">app_port</span>:<span style="color:#bbb"> </span><span style="color:#099">80</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">hello_msg</span>:<span style="color:#bbb"> </span>stranger<span style="color:#bbb">
</span></code></pre></div><p>We&rsquo;ll need both of these files, so save them somewhere on your filesystem.</p>
<h3 id="package-contents-bundle">Package Contents Bundle <a href="#package-contents-bundle" class="section-link">¶</a></h3><p>The first step in creating our package is to create an <a href="/imgpkg/docs/latest/resources/#bundle">imgpkg bundle</a> that contains package contents: above configuration (<code>config.yml</code> and <code>values.yml</code>) and a reference to greeter app image (<code>docker.io/dkalinin/k8s-simple-app@sha256:...</code>).</p>
<p>To start, lets create a directory with above configuration files:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mkdir -p package-contents/config/
$ mv &lt;path to config.yml&gt; package-contents/config/config.yml
$ mv &lt;path to values.yml&gt; package-contents/config/values.yml
</code></pre></div><p>Once we have configuration figured out let&rsquo;s use <code>kbld</code> to record which container images are used:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mkdir -p package-contents/.imgpkg
$ kbld -f package-contents/config/ --imgpkg-lock-output package-contents/.imgpkg/images.yml
</code></pre></div><p>For more on using kbld to populate the <code>.imgpkg</code> directory with an ImageLock, and why it is useful,
see the <a href="/imgpkg/docs/latest/resources/#imageslock-configuration">imgpkg docs on the subject</a></p>
<p>Once these files have been added, our package contents bundle is ready to be pushed as shown below
(<strong>NOTE:</strong> replace <code>registry.corp.com/packages/</code> if working through example):</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ imgpkg push -b registry.corp.com/packages/simple-app:1.0.0 -f package-contents/
dir: .
file: .imgpkg/images.yml
file: config/config.yml
file: config/values.yml
Pushed <span style="color:#d14">&#39;registry.corp.com/packages/simple-app@sha256:e6255cc...&#39;</span>
Succeeded
</code></pre></div><h3 id="creating-the-package-cr">Creating the Package CR <a href="#creating-the-package-cr" class="section-link">¶</a></h3><p>Final step in creating a package is to make a <a href="/kapp-controller/docs/latest/packaging/#package-cr">Package CR</a> that stores metadata such as name, description, how to install, etc. For this example, we will choose <code>simple-app.corp.com</code> as a name for our package with a semantic version <code>1.0.0</code>.</p>
<p>Once the package metadata is filled in, we will need to complete the template section. This is an App template, so take a look at the <a href="/kapp-controller/docs/latest/app-spec/">app-spec</a> section to learn more about what each of the template sections are for. For this example, we have chosen a basic setup that will fetch the imgpkg bundle we created in the previous section, run the templates stored inside through ytt, apply kbld transformations, and then deploy the resulting manifests with kapp.</p>
<p>The result should end up looking something like this:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#000080">apiVersion</span>:<span style="color:#bbb"> </span>package.carvel.dev/v1alpha1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">kind</span>:<span style="color:#bbb"> </span>Package<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic"># Kubernetes name is not used for anything specific but is still required.</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic"># Use ${spec.publicName}.#{spec.version} as a convetion</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">name</span>:<span style="color:#bbb"> </span>simple-app.corp.com.1.0.0<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000080">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic"># publicName will be used by consumers of this package.</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic"># publicName should be unique across all packages, hence we</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic"># recommend to use fully qualified name similar to what</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic"># would be used as a name for a CRD.</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">publicName</span>:<span style="color:#bbb"> </span>simple-app.corp.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic"># version will be used by consumers of this package.</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic"># must be a valid semantic version string.</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">version</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;1.0.0&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#000080">template</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#000080">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">fetch</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#000080">imgpkgBundle</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#998;font-style:italic"># replace image registry and repo with one you are using</span><span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>registry.corp.com/packages/simple-app:1.0.0<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">template</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#000080">ytt</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#000080">paths</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span>- config/<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#000080">kbld</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#000080">paths</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span>- <span style="color:#d14">&#34;-&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">          </span>- .imgpkg/images.yml<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#000080">deploy</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#000080">kapp</span>:<span style="color:#bbb"> </span>{}<span style="color:#bbb">
</span></code></pre></div><p>Lets store this in a file named <code>simple-app.corp.com.1.0.0.yml</code>. Remember to replace
<code>registry.corp.com/packages/</code> in the YAML above with your registry and repository if
following along.</p>
<hr>
<h3 id="testing-your-package">Testing your package <a href="#testing-your-package" class="section-link">¶</a></h3><p>Now that we have our Package CR defined, we can test it on the cluster. We will momentarily act as a package consumer. First, we need to make our package available on the cluster, so let&rsquo;s apply the Package CR we just created directly to the cluster:</p>
<pre><code>$ kapp deploy -a package -f simple-app.corp.com.1.0.0.yml
</code></pre><p>Typically Package CR is made available to the cluster from a package repository, however, in this case it&rsquo;s useful to apply it to the cluster directly since we might need to change it a few times to get things right.</p>
<p>Follow <a href="/kapp-controller/docs/latest/package-consumption/#installing-a-package">Installing a package</a> step from Package consumption workflow to verify that your package can be successfully installed.</p>
<p>(TODO add more info about InstalledPackage status and associated App CR.)</p>
<hr>
<h3 id="creating-a-package-repository">Creating a Package Repository <a href="#creating-a-package-repository" class="section-link">¶</a></h3><p>A package repository is a collection of packages (more specifically collection of Package CRs). Currently our recommended way to make a package repository is by making it an OCI image. (Note that we are actively working on making it possible for package repository to be an imgpkg bundle instead of a plain image. Stay tuned.)</p>
<p>The filesystem structure for package repository image should look like this:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">my-pkg-repo
└── packages
    └── simple-app.corp.com.1.0.0.yml
</code></pre></div><p>Lets start by creating the needed directories:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mkdir -p my-pkg-repo/packages
</code></pre></div><p>Once the directories are created, we can copy our Package CR YAML in to the bundle&rsquo;s <code>packages</code> directory:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cp simple-app.corp.com.1.0.0.yml my-pkg-repo/packages
</code></pre></div><p>With the metadata files present, we can push our repo image to whatever OCI registry we plan to distribute it from:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ imgpkg push -i registry.corp.com/packages/my-pkg-repo:1.0.0 -f my-pkg-repo
</code></pre></div><p>The package repository is pushed. Follow the <a href="/kapp-controller/docs/latest/package-consumption/#adding-package-repository">Adding package repository</a> step from the
package consumption workflow to see an example of adding and using a PackageRepository with kapp-controller.</p>

          </div>
        </div>
      </div>
    </main>
    <footer>
	<div class="wrapper footer-links">
		<div class="clearfix">
			<ul class="left-links">
				<li><a href="https://twitter.com/carvel_dev"><img src="/img/twitter.png" />Twitter</a></li>
				<li><a href="https://github.com/vmware-tanzu/carvel.dev"><img src="/img/github.svg" />Github</a></li>
				<li><a href="https://kubernetes.slack.com/archives/CH8KCCKA5">
					<img src="/img/slack.png" />
					<span class="desktop">#carvel in Kubernetes Slack</span>
					<span class="mobile">Slack</span>
				</a></li>
			</ul>
			<div class="right-links">
				<a href="/"> <img src="/img/logo.svg" /></a>
			</div>
		</div>
		<div class="bottom-links">
			<p class="copywrite">&copy; 2021 Carvel Authors. <a href="http://vmware.github.io/">A VMware-backed project. <img src="/img/vm-logo.svg" /></a></p>
		</div>
	</div>
</footer>

    
    
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
      <script type="text/javascript">
        docsearch({
          apiKey: '582b1408d7a3fe145c0f84f48ca03755',
          indexName: 'carvel',
          inputSelector: '.docsearch-input',
          algoliaOptions: {'facetFilters': ["tags:kapp-controller"], hitsPerPage: 9},
          debug: false 
        });
      </script>
    
  </body>
</html>
